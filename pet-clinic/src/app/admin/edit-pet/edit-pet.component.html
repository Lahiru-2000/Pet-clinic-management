<div class="edit-pet-container">
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3">Loading pet information...</p>
  </div>


  <div *ngIf="!isLoading && pet" class="edit-form-container">

    <div class="page-header">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <button class="btn btn-outline-secondary me-3" (click)="cancel()">
            <i class="bi bi-arrow-left"></i>
            Back to Pets
          </button>
          <h1 class="page-title">
            <i class="bi bi-pencil me-2"></i>
            Edit Pet: {{ pet.name }}
          </h1>
        </div>
      </div>
    </div>

    <div class="form-container">
      <form (ngSubmit)="updatePet()" #petEditForm="ngForm">
        <div class="row g-3">

          <div class="col-md-6">
            <label for="petName" class="form-label">Pet Name *</label>
            <input 
              type="text" 
              id="petName"
              class="form-control" 
              [(ngModel)]="editForm.name" 
              name="name" 
              placeholder="Enter pet's name"
              required>
          </div>

          <div class="col-md-6">
            <label for="petSpecies" class="form-label">Species *</label>
            <select 
              id="petSpecies"
              class="form-select" 
              [(ngModel)]="editForm.type" 
              name="type" 
              (change)="onSpeciesChange()"
              required>
              <option value="">Select Species</option>
              <option *ngFor="let species of speciesOptions" [value]="species">
                {{ species }}
              </option>
            </select>
          </div>

          <div class="col-md-6">
            <label for="petBreed" class="form-label">Breed *</label>
            <select 
              id="petBreed"
              class="form-select" 
              [(ngModel)]="editForm.breed" 
              name="breed" 
              [disabled]="!editForm.type || editForm.type === ''"
              required>
              <option value="">Select Breed</option>
              <option *ngFor="let breed of getAvailableBreeds(editForm.type || '')" [value]="breed">
                {{ breed }}
              </option>
            </select>
            <div *ngIf="!editForm.type || editForm.type === ''" class="form-text">
              <small class="text-muted">Please select a species first</small>
            </div>
          </div>

          <div class="col-md-6">
            <label for="petAge" class="form-label">Age (years) *</label>
            <input 
              type="number" 
              id="petAge"
              class="form-control" 
              [(ngModel)]="editForm.age" 
              name="age" 
              min="0" 
              max="30"
              step="0.1"
              placeholder="Enter pet's age"
              required>
          </div>

          <div class="col-12">
            <label for="ownerEmail" class="form-label">Owner Email *</label>
            <input 
              type="email" 
              id="ownerEmail"
              class="form-control" 
              [(ngModel)]="editForm.owner" 
              name="owner" 
              placeholder="Enter owner's email"
              required>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-secondary me-3" (click)="cancel()">
            Cancel
          </button>
          <button 
            type="submit" 
            class="btn btn-primary" 
            [disabled]="isUpdating || !isValidEditForm()"
          >
            <span *ngIf="isUpdating" class="spinner-border spinner-border-sm me-2" role="status"></span>
            {{ isUpdating ? 'Updating...' : 'Update Pet' }}
          </button>
        </div>
      </form>
    </div>
  </div>

  <div *ngIf="!isLoading && !pet" class="error-container">
    <div class="alert alert-danger">
      <i class="bi bi-exclamation-triangle me-2"></i>
      Pet not found or error loading pet information.
    </div>
    <button class="btn btn-primary" (click)="cancel()">
      Back to Pets
    </button>
  </div>
</div> 